function [Aa, Ab, As] = matrices_A_12g2(param,hx)
% Mathematica, materials12g2.nb
% 9 jan 2020
% A-matrices for pil-model, with "optimal forecaster" info assumption.
bet = param.bet;  
sig = param.sig;
alph = param.alph;
kapp = param.kapp;
psi_x = param.psi_x;
psi_pi = param.psi_pi;
w = param.w;
gbar = param.gbar;
thetbar = param.thetbar;
rho_r = param.rho_r;
rho_i = param.rho_i;
rho_u = param.rho_u;
sig_r = param.sig_r;
sig_i = param.sig_i;
sig_u = param.sig_u;
rho = param.rho;
nx= size(hx,1); % need to figure this out later

% transform these two to be compatible with Mathematica
psipi = psi_pi;
psix = psi_x;

% The only thing you need to specify by hand is 
ia = (eye(nx)-alph*bet*hx)^(-1);
ib = (eye(nx)-bet*hx)^(-1);

% Given the d-matrices, the solution is calculated in Mathematica and
% copied from there:
Aa = [0,(-1).*alph.*bet.*kapp.*((-1).*alph.^(-1)+(-1).*bet.^(-1).* ...
  kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+(-1).*alph.*bet.* ...
  kapp.*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1),0;0,alph.*kapp.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1), ...
  0;0,alph.*kapp.*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).* ...
  kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1),0];
Ab = [0,(-1).*kapp.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1)+bet.*kapp.*((-1).*alph.^(-1)+(-1).* ...
  bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+bet.* ...
  kapp.*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1),0;0,(-1).*alph.^(-1).*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1)+alph.^(-1).*bet.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+alph.^(-1).*bet.*psix.* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1),0;0,(-1).*alph.^(-1).*psix.*((-1).*alph.^(-1)+( ...
  -1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+ ...
  alph.^(-1).*bet.*psix.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+alph.^(-1).*bet.*psix.^2.* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1),0];
% As seems to long for Mathematica or Matlab to handle so I'm doin it brute
% force.
a11 = (-1).*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^( ...
  -1).*psix.*sig).^(-1).*ia(3,1)+(-1).*psix.*sig.*((-1).*alph.^(-1)+ ...
  (-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia( ...
  3,1)+(-1).*alph.^(-2).*bet.^(-1).*((-1).*alph.^(-1)+(-1).*bet.^( ...
  -1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(4,1)+alph.^( ...
  -1).*bet.^(-1).*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,1)+(-1).*alph.^(-2).*bet.^( ...
  -1).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,1)+alph.^(-1).*bet.^(-1).* ...
  psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1).*ia(4,1)+(-1).*kapp.*sig.*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1).*ib(1,1)+kapp.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).* ...
  kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(2,1)+(-1).*bet.^( ...
  -2).*kapp.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ib(4,1)+kapp.*psipi.*sig.*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1).*ib(4,1);
a12 = (-1).*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^( ...
  -1).*psix.*sig).^(-1).*ia(3,2)+(-1).*psix.*sig.*((-1).*alph.^(-1)+ ...
  (-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia( ...
  3,2)+(-1).*alph.^(-2).*bet.^(-1).*((-1).*alph.^(-1)+(-1).*bet.^( ...
  -1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(4,2)+alph.^( ...
  -1).*bet.^(-1).*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,2)+(-1).*alph.^(-2).*bet.^( ...
  -1).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,2)+alph.^(-1).*bet.^(-1).* ...
  psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1).*ia(4,2)+(-1).*kapp.*sig.*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1).*ib(1,2)+kapp.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).* ...
  kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(2,2)+(-1).*bet.^( ...
  -2).*kapp.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ib(4,2)+kapp.*psipi.*sig.*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1).*ib(4,2);
a13 = (-1).*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^( ...
  -1).*psix.*sig).^(-1).*ia(3,3)+(-1).*psix.*sig.*((-1).*alph.^(-1)+ ...
  (-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia( ...
  3,3)+(-1).*alph.^(-2).*bet.^(-1).*((-1).*alph.^(-1)+(-1).*bet.^( ...
  -1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(4,3)+alph.^( ...
  -1).*bet.^(-1).*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,3)+(-1).*alph.^(-2).*bet.^( ...
  -1).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,3)+alph.^(-1).*bet.^(-1).* ...
  psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1).*ia(4,3)+(-1).*kapp.*sig.*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1).*ib(1,3)+kapp.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).* ...
  kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(2,3)+(-1).*bet.^( ...
  -2).*kapp.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ib(4,3)+kapp.*psipi.*sig.*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1).*ib(4,3);
a14 =alph.^(-2).*bet.^(-1).*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+(-1).*alph.^(-1).*bet.^(-1) ...
  .*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1)+bet.^(-2).*kapp.*sig.*((-1).*alph.^(-1)+(-1).* ...
  bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+alph.^(-2) ...
  .*bet.^(-1).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+(-1).*alph.^(-1).*bet.^(-1) ...
  .*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1)+(-1).*((-1).*alph.^(-1)+(-1).*bet.^( ...
  -1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(3,4)+(-1).* ...
  psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1).*ia(3,4)+(-1).*alph.^(-2).*bet.^(-1) ...
  .*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1).*ia(4,4)+alph.^(-1).*bet.^(-1).*((-1).*alph.^(-1) ...
  +(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).* ...
  ia(4,4)+(-1).*alph.^(-2).*bet.^(-1).*psix.*sig.*((-1).*alph.^(-1)+ ...
  (-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia( ...
  4,4)+alph.^(-1).*bet.^(-1).*psix.*sig.*((-1).*alph.^(-1)+(-1).* ...
  bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(4,4)+( ...
  -1).*kapp.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ib(1,4)+kapp.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(2,4)+(-1).*bet.^(-2).*kapp.*sig.*((-1).*alph.^(-1)+(-1).* ...
  bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(4,4)+ ...
  kapp.*psipi.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+( ...
  -1).*alph.^(-1).*psix.*sig).^(-1).*ib(4,4);

a21 = bet.^(-1).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(3,1)+alph.^(-2).*bet.^(-2).* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1).*ia(4,1)+(-1).*alph.^(-1).*bet.^(-2).*sig.*(( ...
  -1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1).*ia(4,1)+(-1).*alph.^(-1).*sig.*((-1).*alph.^(-1) ...
  +(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).* ...
  ib(1,1)+alph.^(-1).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(2,1)+(-1).*alph.^(-1).* ...
  bet.^(-2).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ib(4,1)+alph.^(-1).*psipi.*sig.*(( ...
  -1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1).*ib(4,1);
a22 = bet.^(-1).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(3,2)+alph.^(-2).*bet.^(-2).* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1).*ia(4,2)+(-1).*alph.^(-1).*bet.^(-2).*sig.*(( ...
  -1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1).*ia(4,2)+(-1).*alph.^(-1).*sig.*((-1).*alph.^(-1) ...
  +(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).* ...
  ib(1,2)+alph.^(-1).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(2,2)+(-1).*alph.^(-1).* ...
  bet.^(-2).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ib(4,2)+alph.^(-1).*psipi.*sig.*(( ...
  -1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1).*ib(4,2);
a23 = bet.^(-1).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(3,3)+alph.^(-2).*bet.^(-2).* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1).*ia(4,3)+(-1).*alph.^(-1).*bet.^(-2).*sig.*(( ...
  -1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1).*ia(4,3)+(-1).*alph.^(-1).*sig.*((-1).*alph.^(-1) ...
  +(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).* ...
  ib(1,3)+alph.^(-1).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(2,3)+(-1).*alph.^(-1).* ...
  bet.^(-2).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ib(4,3)+alph.^(-1).*psipi.*sig.*(( ...
  -1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1).*ib(4,3);
a24 = (-1).*alph.^(-2).*bet.^(-2).*sig.*((-1).*alph.^(-1)+(-1).*bet.^( ...
  -1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+2.*alph.^(-1).* ...
  bet.^(-2).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1)+bet.^(-1).*sig.*((-1).*alph.^(-1)+( ...
  -1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia( ...
  3,4)+alph.^(-2).*bet.^(-2).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1) ...
  .*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(4,4)+(-1).* ...
  alph.^(-1).*bet.^(-2).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).* ...
  kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(4,4)+(-1).* ...
  alph.^(-1).*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ib(1,4)+alph.^(-1).*sig.*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1).*ib(2,4)+(-1).*alph.^(-1).*bet.^(-2).*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(4,4)+alph.^(-1).*psipi.*sig.*((-1).*alph.^(-1)+(-1).*bet.^( ...
  -1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(4,4);

a31 = bet.^(-1).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(3,1)+alph.^(-2).*bet.^( ...
  -2).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,1)+(-1).*alph.^(-1).*bet.^( ...
  -2).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,1)+(-1).*alph.^(-1).*psix.* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1).*ib(1,1)+alph.^(-1).*psix.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(2,1)+(-1).*alph.^(-1).*bet.^(-2).*psix.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(4,1)+alph.^(-1).*psipi.*psix.*sig.*((-1).*alph.^(-1)+(-1).* ...
  bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(4,1); ...
a32 = (-1).*alph.^(-1).*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+( ...
  -1).*alph.^(-1).*psix.*sig).^(-1)+(-1).*bet.^(-1).*kapp.*sig.*(( ...
  -1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).* ...
  psix.*sig).^(-1)+(-1).*alph.^(-1).*psix.*sig.*((-1).*alph.^(-1)+( ...
  -1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+ ...
  bet.^(-1).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(3,2)+alph.^(-2).*bet.^( ...
  -2).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,2)+(-1).*alph.^(-1).*bet.^( ...
  -2).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,2)+(-1).*alph.^(-1).*psix.* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1).*ib(1,2)+alph.^(-1).*psix.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(2,2)+(-1).*alph.^(-1).*bet.^(-2).*psix.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(4,2)+alph.^(-1).*psipi.*psix.*sig.*((-1).*alph.^(-1)+(-1).* ...
  bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(4,2); ...
a33 = bet.^(-1).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ia(3,3)+alph.^(-2).*bet.^( ...
  -2).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,3)+(-1).*alph.^(-1).*bet.^( ...
  -2).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(4,3)+(-1).*alph.^(-1).*psix.* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1).*ib(1,3)+alph.^(-1).*psix.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(2,3)+(-1).*alph.^(-1).*bet.^(-2).*psix.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(4,3)+alph.^(-1).*psipi.*psix.*sig.*((-1).*alph.^(-1)+(-1).* ...
  bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(4,3); ...
a34 = (-1).*alph.^(-1).*psipi.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.* ...
  sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+(-1).*bet.^(-1).*kapp.* ...
  psipi.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1)+(-1).*alph.^(-2).*bet.^(-2).*psix.* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1)+2.*alph.^(-1).*bet.^(-2).*psix.*sig.*((-1).* ...
  alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig) ...
  .^(-1)+(-1).*alph.^(-1).*psipi.*psix.*sig.*((-1).*alph.^(-1)+(-1) ...
  .*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1)+bet.^( ...
  -1).*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1) ...
  .*alph.^(-1).*psix.*sig).^(-1).*ia(3,4)+alph.^(-2).*bet.^(-2).* ...
  psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1).*ia(4,4)+(-1).*alph.^(-1).*bet.^(-2) ...
  .*psix.*sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).* ...
  alph.^(-1).*psix.*sig).^(-1).*ia(4,4)+(-1).*alph.^(-1).*psix.* ...
  sig.*((-1).*alph.^(-1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1) ...
  .*psix.*sig).^(-1).*ib(1,4)+alph.^(-1).*psix.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(2,4)+(-1).*alph.^(-1).*bet.^(-2).*psix.*sig.*((-1).*alph.^( ...
  -1)+(-1).*bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1) ...
  .*ib(4,4)+alph.^(-1).*psipi.*psix.*sig.*((-1).*alph.^(-1)+(-1).* ...
  bet.^(-1).*kapp.*sig+(-1).*alph.^(-1).*psix.*sig).^(-1).*ib(4,4); ...

As = [a11,a12,a12,a14;  ...
    a21, a22, a23, a24; ...
    a31, a32, a33, a34];

mathematica_code = "/Users/lauragati/Dropbox/BC_Research/next/code/materials12g2.nb";
this_code = mfilename;
mname = strrep(this_code,'matrices_A_','')
mmcaname = extractBetween(mathematica_code,"/Users/lauragati/Dropbox/BC_Research/next/code/materials",".nb")

if strcmp(mname,mmcaname) ~=1
    error('not using the correct A-matrices from Mathematica!')
end
  